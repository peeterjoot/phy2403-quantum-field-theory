%
% Copyright © 2018 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
%{
%%\input{../latex/blogpost.tex}
%%\renewcommand{\basename}{qftLecture5}
%%\renewcommand{\dirname}{notes/phy2403/}
%%\newcommand{\keywords}{PHY2403H}
%%\input{../latex/peeter_prologue_print2.tex}
%%
%%%\usepackage{phy2403}
%%\usepackage{peeters_braket}
%%%\usepackage{peeters_layout_exercise}
%%\usepackage{peeters_figures}
%%\usepackage{mathtools}
%%\usepackage{siunitx}
%%\usepackage{macros_cal} % LL
%%
%%\beginArtNoToc
%%\generatetitle{PHY2403H Quantum Field Theory.  Lecture 5: Klein-Gordon equation, SHOs, momentum space representation, raising and lowering operators..  Taught by Prof.\ Erich Poppitz}
%\chapter{Klein-Gordon equation, SHOs, momentum space representation, raising and lowering operators.}
\index{Klein-Gordon}
\index{simple harmonic oscillator}
\index{momentum space representation}
\index{raising operator}
\index{lowering operator}
\label{chap:qftLecture5}

%\paragraph{DISCLAIMER: Very rough notes from class.  Some additional side notes, but otherwise barely edited.}
%
%These are notes for the UofT course PHY2403H, Quantum Field Theory I, taught by Prof. Erich Poppitz fall 2018.
%%, covering \textchapref{{1}} \citep{peskin1995introduction} content.

\section{Canonical quantization.}
\index{canonical quantization}

Last time we introduced a Lagrangian density associated with the Klein-Gordon equation (with a quadratic potential coupling)
\begin{dmath}\label{eqn:qftLecture5:20}
L = \int d^3 x
\lr{
\inv{2} \lr{\partial_0 \phi}^2 - \inv{2} \lr{\spacegrad \phi}^2 - \frac{m^2}{2} \phi^2  - \frac{\lambda}{4} \phi^4
}.
\end{dmath}
This Lagrangian density was related to the action by
\begin{equation}\label{eqn:qftLecture5:40}
S = \int dt L = \int dt d^3 x \LL,
\end{equation}
with momentum canonically conjugate to the field \( \phi \) defined as
\begin{equation}\label{eqn:qftLecture5:60}
\pi(\Bx, t) = \frac{\delta \LL}{\delta \phidot(\Bx, t) } = \PD{\phidot(\Bx, t)}{\LL}
\end{equation}

The Hamiltonian defined as
\begin{dmath}\label{eqn:qftLecture5:80}
H = \int d^3 x \lr{ \pi(\Bx, t) \phidot(\Bx, t) - \LL },
\end{dmath}
led to
\begin{dmath}\label{eqn:qftLecture5:680}
H
= \int d^3 x
\lr{ \inv{2} \pi^2 + (\spacegrad \phi)^2 + \inv{2} m^2 \phi^2 + \frac{\lambda}{4} \phi^4 }.
\end{dmath}
Like the Lagrangian density, we may introduce a Hamiltonian density \( \calH \) as
\begin{dmath}\label{eqn:qftLecture5:100}
H = \int d^3 x \calH(\Bx, t).
\end{dmath}
For our Klein-Gordon system, this is
\begin{dmath}\label{eqn:qftLecture5:120}
\calH(\Bx, t) =
\inv{2} \pi^2 + (\spacegrad \phi)^2 + \inv{2} m^2 \phi^2 + \frac{\lambda}{4} \phi^4.
\end{dmath}

\paragraph{Canonical Commutation Relations (CCR)}:
\index{canonical commutation relations}
\index{CCR}

We quantize the system by promoting our fields to Heisenberg-Picture (HP) operators, and imposing commutation relations
\begin{dmath}\label{eqn:qftLecture5:140}
\antisymmetric{\hat{\pi}(\Bx, t)}{\hat{\phi}(\By, t)} = -i \deltathree (\Bx - \By),
\end{dmath}
which is analogous to
\begin{dmath}\label{eqn:qftLecture5:160}
\antisymmetric{\hat{p}_i}{\hat{q}_j} = -i \delta_{ij}.
\end{dmath}

To choose a representation, we may map the \( \Psi \) of QM \( \rightarrow \) to a wave functional \( \Psi[\phi] \)
\begin{dmath}\label{eqn:qftLecture5:180}
\hat{\phi}(\By, t) \Psi[\phi] = \phi(\By, t) \Psi[\phi]
\end{dmath}

This is similar to the QM wave functions
\begin{dmath}\label{eqn:qftLecture5:200}
\begin{aligned}
\hat{q}_i \Psi(\setlr{q}) &= q_i \Psi(q) \\
\hat{p}_i \Psi(\setlr{q}) &= -i \PD{q_i}{} \Psi(p)
\end{aligned}
\end{dmath}

Our momentum operator is quantized by expressing it in terms of a variational derivative
\begin{dmath}\label{eqn:qftLecture5:220}
\hat{\pi}(\Bx, t) = -i \frac{\delta}{\delta \phi(\Bx, t)}.
\end{dmath}
(Fixme: I'm not really sure exactly what is meant by using the variation derivative \(\delta\) notation here), and to
quantize the Hamiltonian we just add hats, assuming that our fields are all now HP operators
\begin{dmath}\label{eqn:qftLecture5:240}
\hat{\calH}(\Bx, t)
=
\inv{2} \hat{\pi}^2 + (\spacegrad \hat{\phi})^2 + \inv{2} m^2 \hat{\phi}^2 + \frac{\lambda}{4} \hat{\phi}^4.
\end{dmath}

\paragraph{QM SHO review}
\index{simple harmonic oscillator}
Recall the QM SHO had a Hamiltonian
\begin{dmath}\label{eqn:qftLecture5:260}
\hat{H} = \inv{2} \hat{p}^2 + \inv{2} \omega^2 \hat{q}^2,
\end{dmath}
where
\begin{dmath}\label{eqn:qftLecture5:280}
\antisymmetric{\hat{p}}{\hat{q}} = -i,
\end{dmath}
and that
HP time evolution operators \( O \) satisfied
\begin{dmath}\label{eqn:qftLecture5:700}
\ddt{\hatO} = i \antisymmetric{\hatH}{\hatO}.
\end{dmath}
In particular
\begin{dmath}\label{eqn:qftLecture5:300}
\ddt{\hat{p}}
= i \antisymmetric{\hat{H}}{\hatp}
= i \frac{\omega^2}{2} \antisymmetric{\hatq^2}{\hatp}
= i \frac{\omega^2}{2} (2 i \hatq)
= -i \omega^2 \hatq,
\end{dmath}
and
\begin{dmath}\label{eqn:qftLecture5:320}
\ddt{\hat{q}}
= i \antisymmetric{\hat{H}}{\hatq}
= i \inv{2} \antisymmetric{\hatp^2}{\hatq}
= \frac{i}{2}(-2 i \hatp )
= \hatp.
\end{dmath}
Applying the time evolution operator twice, we find
\begin{equation}\label{eqn:qftLecture5:340}
\frac{d^2}{dt^2}{\hat{q}}
= \ddt{\hat{p}}
= - \omega^2 \hatq.
\end{equation}
We see that the Heisenberg operators obey the classical equations of motion.

Now we want to try this with the quantized QFT fields we've promoted to operators
\begin{dmath}\label{eqn:qftLecture5:360}
\ddt{\hat{\pi}}(\Bx, t)
= i \antisymmetric{\hatH}{\hat{\pi}(\Bx, t)}
=
i \int d^3 y \inv{2} \antisymmetric{ \lr{\spacegrad \phihat(\By) }^2 }{\pihat(\Bx) }
+
i \int d^3 y \frac{m^2}{2} \antisymmetric{ \phihat(\By)^2 }{\pihat(\Bx) }
+
i \frac{\lambda}{4} \int d^3 \antisymmetric{ \phihat(\By)^4 }{\pihat(\Bx) }.
\end{dmath}

Starting with the non-gradient commutators, and
utilizing the HP field analogues of the relations \( \antisymmetric{\hatq^n}{\hatp} = n i \hatq^{n-1} \), we find
\begin{equation}\label{eqn:qftLecture5:780}
\int d^3 y \antisymmetric{ \lr{ \phihat(\By) }^2 }{\pihat(\Bx) }
=
\int d^3 y 2 i \phihat(\By) \deltathree(\Bx - \By)
= 2 i \phihat(\Bx).
\end{equation}
\begin{equation}\label{eqn:qftLecture5:740}
\int d^3 y \antisymmetric{ \lr{ \phihat(\By) }^4 }{\pihat(\Bx) }
=
\int d^3 y 4 i \phihat(\By)^3 \deltathree(\Bx - \By)
= 4 i \phihat(\Bx)^3.
\end{equation}
For the gradient commutators, we have more work.  Prof Poppitz blitzed through that, just calling it integration by parts.  I had trouble seeing what he was doing, so here's a more explicit dumb expansion required to calculate the commutator
\begin{dmath}\label{eqn:qftLecture5:720}
\int d^3 y (\spacegrad \phihat(\By))^2 \pihat(\Bx)
=
\int d^3 y
\lr{ \spacegrad \phihat(\By) \cdot \spacegrad \phihat(\By) } \pihat(\Bx)
=
\int d^3 y
\spacegrad \phihat(\By) \cdot
\lr{ \spacegrad (\phihat(\By) \pihat(\Bx)) }
=
\int d^3 y
\spacegrad \phihat(\By) \cdot
\lr{ \spacegrad (\pihat(\Bx) \phihat(\By) + i \deltathree(\Bx - \By)) }
=
\int d^3 y
\Biglr{
   \spacegrad \lr{ \phihat(\By) \pihat(\Bx) } \cdot \spacegrad \phihat(\By)
   + i
   \spacegrad \phihat(\By) \cdot \spacegrad \deltathree(\Bx - \By)
}
=
\int d^3 y
\Biglr{
   \spacegrad \lr{ \pihat(\Bx) \phihat(\By) + i \deltathree(\Bx - \By) } \cdot \spacegrad \phihat(\By)
   + i
   \spacegrad \phihat(\By) \cdot \spacegrad \deltathree(\Bx - \By)
}
=
\int d^3 y
   \pihat(\Bx)
\lr{
   \spacegrad \phihat(\By) \cdot \spacegrad \phihat(\By)
}
+ 2 i
\int d^3 y
   \spacegrad \phihat(\By) \cdot \spacegrad \deltathree(\Bx - \By)
=
\int d^3 y
   \pihat(\Bx) \spacegrad^2 \phihat(\By)
+
2 i
\int d^3 y
   \spacegrad \cdot \lr{ \deltathree(\Bx - \By) \spacegrad \phihat(\By) }
-
2 i
\int d^3 y
   \deltathree(\Bx - \By) \spacegrad^2 \phihat(\By)
=
\int d^3 y
   \pihat(\Bx) \spacegrad^2 \phihat(\By)
+
2 i
\int_\partial d^2 y
   \deltathree(\Bx - \By)
   \ncap \cdot \spacegrad \phihat(\By)
-
2 i \spacegrad^2 \phihat(\Bx).
\end{dmath}
Here we take advantage of the fact that the derivative operators \( \spacegrad = \spacegrad_\By \) commute with \( \pihat(\Bx) \), and use the identity
\( \spacegrad \cdot (a \spacegrad b) = (\spacegrad a) \cdot (\spacegrad b) + a \spacegrad^2 b \), so the commutator is
\begin{dmath}\label{eqn:qftLecture5:800}
\int d^3 y \antisymmetric{(\spacegrad \phihat(\By))^2}{\pihat(\Bx)}
=
2 i
\int_\partial d^2 y
   \deltathree(\Bx - \By)
   \ncap \cdot \spacegrad \phihat(\By)
-
2 i \spacegrad^2 \phihat(\Bx)
=
-
2 i \spacegrad^2 \phihat(\Bx),
\end{dmath}
where the boundary integral is presumed to be zero (without enough justification.)
All the pieces can now be put back together
\begin{dmath}\label{eqn:qftLecture5:820}
\ddt{} \hat{\pi}(\Bx, t)
=
\spacegrad^2 \phihat(\Bx, t)
-
m^2 \phihat(\Bx, t)
-
\lambda \phihat^3(\Bx, t).
\end{dmath}

Now, for the \( \phihat \) time evolution, which is much easier
\begin{dmath}\label{eqn:qftLecture5:380}
\ddt{\hat{\phi}}(\Bx, t)
= i \antisymmetric{\hatH}{\hat{\phi}(\Bx, t)}
= i \inv{2} \int d^3 y \antisymmetric{\pihat^2(\By)}{\hat{\phi}(\Bx)}
= i \inv{2} \int d^3 y (-2 i) \pihat(\By, t) \deltathree(\Bx - \By)
= \pihat(\Bx, t)
\end{dmath}
\begin{dmath}\label{eqn:qftLecture5:400}
\frac{d^2}{dt^2}{\hat{\phi}}(\Bx, t)
=
\spacegrad^2 \phi
-m^2 \phi - \lambda \phihat^3.
\end{dmath}
That is
\begin{dmath}\label{eqn:qftLecture5:420}
\ddot{\phihat} - \spacegrad^2 \phihat + m^2 \phihat + \lambda \phihat^3 = 0,
\end{dmath}
which is the classical Euler-Lagrange equation, also obeyed by the
Heisenberg operator \( \phi(\Bx, t) \).  When \( \lambda = 0 \) this is the Klein-Gordon equation.

\section{Momentum space representation.}
\index{momentum space representation}
Dropping hats, we now consider the momentum space representation of our operators, as determined by Fourier transform pairs
\begin{dmath}\label{eqn:qftLecture5:440}
\begin{aligned}
\phi(\Bx, t) &= \int \frac{d^3 p}{(2\pi)^3} e^{i \Bp \cdot \Bx} \tilde{\phi}(\Bp, t) \\
\tilde{\phi}(\Bp, t) &= \int d^3 x e^{-i \Bp \cdot \Bx} \phi(\Bx, t).
\end{aligned}
\end{dmath}

We can discover a representation of the delta function by applying these both in turn
\begin{dmath}\label{eqn:qftLecture5:480}
\tilde{\phi}(\Bp, t)
= \int d^3 x e^{-i \Bp \cdot \Bx} \int \frac{d^3 q}{(2 \pi)^3} e^{i \Bq \cdot \Bx} \tilde{\phi}(\Bq, t)
\end{dmath}
so
\boxedEquation{eqn:qftLecture5:500}{
\int d^3 x e^{i \BA \cdot \Bx} = (2 \pi)^3 \deltathree(\BA)
}

Also observe that \( \phi^\conj(\Bx, t) = \phi(\Bx, t) \) iff \( \tilde{\phi}(\Bp, t) = \tilde{\phi}^\conj(-\Bp, t) \).

We want the equations of motion for \( \tilde{\phi}(\Bp, t) \) where the operator obeys the Klein-Gordon equation
\begin{dmath}\label{eqn:qftLecture5:520}
\lr{ \partial_t^2 - \spacegrad^2 + m^2 } \phi(\Bx, t) = 0
\end{dmath}

Inserting the transform relation \cref{eqn:qftLecture5:440} we get
\begin{dmath}\label{eqn:qftLecture5:540}
\int \frac{d^3 p}{(2 \pi)^3} e^{i \Bp \cdot \Bx}
\lr{
\ddot{\tilde{\phi}}(\Bp, t) + \lr{ \Bp^2 + m^2 }
\tilde{\phi}(\Bp, t)
}
= 0,
\end{dmath}
or
\boxedEquation{eqn:qftLecture5:580}{
\ddot{\tilde{\phi}}(\Bp, t) = - \omega_\Bp^2 \,\tilde{\phi}(\Bp, t),
}
where
\begin{dmath}\label{eqn:qftLecture5:560}
\omega_\Bp = \sqrt{ \Bp^2 + m^2 }.
\end{dmath}
The Fourier components of the HP operators are SHOs!

As we have SHO's and know how to deal with these in QM, we use the same strategy, introducing raising and lowering operators
\begin{dmath}\label{eqn:qftLecture5:600}
\tilde{\phi}(\Bp, t) = \inv{\sqrt{2 \omega_\Bp}} \lr{ e^{-i \omega_\Bp t } a_\Bp + e^{i \omega_\Bp t} a^\dagger_{-\Bp}.
}
\end{dmath}

Observe that
\begin{dmath}\label{eqn:qftLecture5:840}
\tilde{\phi}^\dagger(-\Bp, t)
= \inv{\sqrt{2 \omega_\Bp}} \lr{ e^{i \omega_\Bp t } a^\dagger_{-\Bp} + e^{-i \omega_\Bp t} a_{\Bp} }
=
\tilde{\phi}(\Bp, t),
\end{dmath}
or
\begin{dmath}\label{eqn:qftLecture5:620}
\tilde{\phi}^\dagger(\Bp, t) = \tilde{\phi}(-\Bp, t),
\end{dmath}
so \( \phi(\Bp, t) \) has a real representation in terms of \( a_\Bp \).

We will find (Wednesday) that
\begin{dmath}\label{eqn:qftLecture5:640}
\antisymmetric
{a_\Bq}
{a^\dagger_\Bp}
=
(2 \pi)^3
\deltathree(\Bp - \Bq),
\end{dmath}
which are equivalent to
\begin{dmath}\label{eqn:qftLecture5:660}
\antisymmetric{\tilde{\pi}(\Bp, t)}{\tilde{\phi}(\Bq, t)} = -i \deltathree(\Bp - \Bq).
\end{dmath}

%}
%\EndNoBibArticle
