%
% Copyright © 2018 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\makeproblem{The Wick theorem(s)}{qft:problemSet4:1}{

{\bf The mother of all Wick theorem(s): }
Let $A_1, A_2,... $ and $B$ denote a set of either creation or annihilation operators. In other words, $A_i = a_{k_i}$ or $a_{k_i}^\dagger$ (as well as $B$; $B$ is just like one of the $A$'s, but we'll use the letter $B$ to denote an operator which is singled out, as it is needed in the proof). Next, define a contraction $A_i A_k$ as follows:
\begin{equation}
\label{c1}
\contraction{O_1}{A}{{}_i O_2}{A}
O_1 A_i O_2 A_k =   O_1 O_2 \contraction{}{A}{{}_i} {A}  A_i A_k ~,
 \end{equation}
 where $O_1$, $O_2$ are arbitrary strings of operators. The above equation signifies the fact that the ``contraction" is a $c$-number, i.e. commutes with all operators. It is defined as follows:
  \begin{equation}
\label{c2}
  \contraction{}{A}{{}_i} {A}  A_i A_j = \left\{ \begin{array}l 0, \; {\rm if } \; \; A_i = a_{k_i}, A_j = a_{k_j} \;\; {\rm or} \;\; A_i = a_{k_i}^\dagger, A_j = a_{k_j}^\dagger\cr 0, \; {\rm if } \; \; A_i = a_{k_i}^\dagger \; \; {\rm and} \; \; A_j = a_{k_j} \cr
(2 \pi)^3  \delta^{(3)}(k_i - k_j),  \; {\rm if } \; \; A_i = a_{k_i} \; \; {\rm and} \; \; A_j = a_{k_j}^\dagger
 \end{array}~ \right.
 \end{equation}
 Put in words, the contraction vanishes if both $A$'s are creation (or both are annihilation operators), as indicated in the first line in \cref{c2}. The contraction is also zero if the operator to the right is an annihilation one, as per the second line in \cref{c2}. Finally, the contraction is equal to the commutator of $a_{k_i}$ with $a_{k_j}^\dagger$ in the case when the creation operator is to the left of the annihilation operator.

 Finally, we use $:A \ldots B:$ to denote the expression where all annihilation operators appear to the right of all creation operators, i.e. the usual normal ordered expression. Then,
 Wick's theorem---as used in many body physics---is formulated as follows:
\begin{dmath}\label{w1}
\begin{aligned}
 A_1 \ldots A_n &=
\normalorder{A_1 \ldots A_n}  \\
&+
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 A_3\ldots A_n}
+ \ldots +
\normalorder{\contraction{}{A}{{}_1\ldots}{A} A_1 \ldots A_{n-1} A_n}
+
\normalorder{\contraction{}{A}{{}_1 \ldots}{A} A_1 \ldots A_{n}}  \\
&+
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 \contraction{}{A}{{}_3}{A} A_3 A_4 \ldots A_n}
 + \ldots.
\end{aligned}
\end{dmath}
% \begin{eqnarray}
% \label{w1}
% A_1 \ldots A_n &=& \;\;\; :A_1 \ldots A_n:\nonumber \\
% & & + :\contraction{}{A}{{}_1}{A} A_1 A_2 A_3\ldots A_n: + \ldots + :\contraction{}{A}{{}_1\ldots}{A} A_1 \ldots A_{n-1} A_n: + :\contraction{}{A}{{}_1 \ldots}{A} A_1 \ldots A_{n}: \\
% && + :\contraction{}{A}{{}_1}{A} A_1 A_2 \contraction{}{A}{{}_3}{A} A_3 A_4 \ldots A_n: + \ldots \nonumber~.
% \end{eqnarray}
 The first line contains the normal-ordered product of all operators without contractions, the second line---all possible terms with one contraction (not involving only $A_1$ of course, but all single-contraction terms, which would be painful to indicate), the third line has all possible two-contraction terms, etc.

Now, you will prove \cref{w1} in steps.
\makesubproblem{}{qft:problemSet4:1a}
Prove the following Lemma:
 \begin{equation}
 \label{lemma}
  :A_1 A_2 \ldots A_n: B =  :A_1 A_2 \ldots A_n  B: + \sum\limits_{1 \le k \le n}:A_1 \ldots \contraction{}{A}{{}_k \ldots A_n}{B} A_k \ldots A_n B:
 \end{equation} Argue that if $B$ is an annihilation operator, the Lemma is trivial. Thus, consider $B$ to be a creation operator.
 Notice  that if any of the $A_{1,...,n}$ are creation operators, they can be taken to the left of the normal products in \cref{lemma} (because all their contractions with $B$ are zero). Thus, if the \cref{lemma} is proven for arbitrary $n$ for the case when all $A_i$'s are annihilation operators, the general case is obtained by multiplying on the left with the desired number of creation operators. Thus, it suffices to prove the Lemma for the case when all $A_i$'s are annihilation operators. Also
notice
  Thus, after proving the Lemma for $n=1$, use induction to show that it holds for any $n$. Assuming it holds for some number $n$, go to the case $n+1$ by multiplying \cref{lemma}  by some annihilation operator $A_0$ on the left and show that the Lemma holds for $n+1$ operators.

  By the chain of logic described above, you have proven \cref{lemma}.

Notice also that the lemma \cref{lemma} holds also if the product $$:A_1 A_2 \ldots A_n:$$ is replaced by
\begin{dmath}\label{eqn:ProblemSet4Problem1:160}
\normalorder{
A_1 \contraction{}{A}{{}_2\ldots}{A} A_2 \ldots  A_p \ldots A_n},
\end{dmath}
  i.e. with the product of operators with an arbitrary number of contractions (one, as written above), with a trivial modification of the last term (since, obviously, you can not contract $B$ with contractions).
\makesubproblem{}{qft:problemSet4:1b}
Now prove the actual Wick theorem \cref{w1}. Assuming that it holds for $n=2$. Imagine that \cref{w1} holds for $n$ operators and prove that it holds for $n+1$, using \cref{lemma}.
\makesubproblem{}{qft:problemSet4:1c}
{\bf An intermediate step:} Let now $A_i$ and $B$ be operators expressed as some linear combinations of creation and annihilation operators. In particular the subscripts $i$ may now indicate spatial dependence, rather than momentum eigenvalues. Now, define the contraction as follows:
   \begin{equation}
    \label{c5}
  \contraction{}{A}{{}_i} {A}  A_i A_j = \langle 0 \vert A_i A_j \vert 0 \rangle~,
 \end{equation}
 where $\vert 0 \rangle$ is the Fock vacuum.
Notice that \cref{c5} is equivalent to \cref{c2} when $A_i$'s are either creation or annihilation operators. Argue that \cref{w1} holds verbatim.

\makesubproblem{}{qft:problemSet4:1d}
{\bf The time-ordered Wick theorem:} Use the above Wick theorem to prove the time-ordered version. Notice that, despite appearances, there is not much left to do. Now, we have space-time rather than momentum space arguments and the theorem is now formulated as follows:\begin{eqnarray}
 \label{w2}
T( A_1 \ldots A_n ) &=& \;\;\; :A_1 \ldots A_n:\nonumber \\
 & & + :\contraction{}{A}{{}_1}{A} A_1 A_2 A_3\ldots A_n: + \ldots + :\contraction{}{A}{{}_1\ldots}{A} A_1 \ldots A_{n-1} A_n: + :\contraction{}{A}{{}_1\ldots}{A} A_1 \ldots A_{n}: \\
 && + :\contraction{}{A}{{}_1}{A} A_1 A_2 \contraction{}{A}{{}_3}{A} A_3 A_4 \ldots A_n: + \ldots \nonumber~,
 \end{eqnarray}
 with the difference that $A_i$ are fields (we are considering real scalar fields),  $1 \ldots n$ denote space-time points, and the contraction is now the Feynman propagator, e.g. $D_F(x_1-x_2)$, etc.

 Notice that  to prove (\ref{w2}) one can consider a particular time ordering. Then the $T$ product becomes the normal product of operators (as they are assumed ordered). The space-time dependence can be taken out by Fourier transform which multiplies every term.  Every operator is a sum of creation and annihilation operators. Their commutators are exactly the ones giving rise to the contraction in \cref{c2}, on one hand, and to the function $D(x_i -x_j)$ after Fourier transform, on the other (recall that this function appears in the Feynman propagator).
Convince yourselves, using \cref{c5},  that this proves the theorem.

\makesubproblem{}{qft:problemSet4:1e}
For extra bonus, generalize all theorems above to anti commuting fields.
} % makeproblem

\makeanswer{qft:problemSet4:1}{
\makeSubAnswer{}{qft:problemSet4:1a}
The normal ordered sequence \( \normalorder{ A_1 A_2 \ldots A_n} B \) has the form
\begin{dmath}\label{eqn:ProblemSet4Problem1:20}
a_{k_1}^\dagger
\ldots
a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_n}
B
\end{dmath}
so if \( B = a_{k_{n+1}} \) is an anhillation operator the result is already normal ordered.  Since the Wick contraction with such a \( B \) is zero for all \( A_i \), that is
\begin{dmath}\label{eqn:ProblemSet4Problem1:40}
\begin{aligned}
\contraction{}{a}{{}_{k_1}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots a_{k_n} }{a}
a_{k_1}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots a_{k_n} a_{k_{n+1}}
&= 0 \\
\contraction{a_{k_1}^\dagger }{a}{{}_{k_2}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots a_{k_n}}{a}
a_{k_1}^\dagger a_{k_2}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots a_{k_n} a_{k_{n+1}}
&= 0 \\
\vdots & \\
\contraction{a_{k_1}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots }{a}{{}_{k_n}}{a}
a_{k_1}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots a_{k_n} a_{k_{n+1}}
&= 0,
\end{aligned}.
\end{dmath}
Summarizing, we see that for anhillation operators \( B \) we have
\begin{dmath}\label{eqn:ProblemSet4Problem1:100}
\normalorder{A_1 A_2 \ldots A_n} B =  \normalorder{A_1 A_2 \ldots A_n  B},
\end{dmath}
and
\begin{dmath}\label{eqn:ProblemSet4Problem1:200}
\sum\limits_{1 \le k \le n} \normalorder{A_1 \ldots \contraction{}{A}{{}_k \ldots A_n}{B} A_k \ldots A_n B} = 0,
\end{dmath}
so \cref{lemma} is valid for any anhillation operator \( B \).

For creation operators \( B \), we can cast the commutatation relations into Wick form
\begin{dmath}\label{eqn:ProblemSet4Problem1:60}
a_m a_k^\dagger
=
a_k^\dagger a_m + (2\pi)^3 \deltathree(k - m)
=
a_k^\dagger a_m +
\contraction{}{a}{{}_m}{a}
a_m a_k^\dagger,
\end{dmath}
and use this iteratively to percolate \( B = a_{n+1}^\dagger \) through \( \normalorder{A_1 A_2 \ldots A_n} \).  That is
\begin{dmath}\label{eqn:ProblemSet4Problem1:80}
\normalorder{A_1 A_2 \ldots A_n} B
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger a_{k_{r+1}} \ldots a_{k_n} a_{k_{n+1}}^\dagger
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-1}}
\lr{
   a_{k_{n+1}}^\dagger
   a_{k_n}
   +
   \contraction{}{a}{{}_{k_n} }{a}
   a_{k_n} a_{k_{n+1}}^\dagger
}
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-1}}
a_{k_{n+1}}^\dagger
a_{k_n}
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\contraction{}{a}{{}_{k_n} }{a}
a_{k_n} a_{k_{n+1}}^\dagger
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-2}}
\lr{
a_{k_{n+1}}^\dagger
a_{k_{n-1}}
+
\contraction{}{a}{{}_{k_{n+1}} }{a}
a_{k_{n-1}} a_{k_{n+1}}^\dagger
}
a_{k_n}
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\contraction{}{a}{{}_{k_n} }{a}
a_{k_n} a_{k_{n+1}}^\dagger
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-2}}
a_{k_{n+1}}^\dagger
a_{k_{n-1}}
a_{k_n}
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-2}}
\contraction{}{a}{{}_{k_{n+1}} }{a}
a_{k_{n-1}} a_{k_{n+1}}^\dagger
a_{k_n}
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\contraction{}{a}{{}_{k_n} }{a}
a_{k_n} a_{k_{n+1}}^\dagger.
\end{dmath}
We can continue like this until \( a^\dagger_{k_{n+1}} \) has percolated all the way through the anhillation operators
\begin{dmath}\label{eqn:ProblemSet4Problem4:120}
\normalorder{A_1 A_2 \ldots A_n} B
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
\contraction{}{a}{{}_{k_{r+1}}}{a}
a_{k_{r+1}}
a_{k_{n+1}}^\dagger
\ldots
a_{k_{n-1}}
a_{k_n}
+
\cdots
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-2}}
\contraction{}{a}{{}_{k_{n+1}} }{a}
a_{k_{n-1}} a_{k_{n+1}}^\dagger
a_{k_n}
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
\contraction{}{a}{{}_{k_n} }{a}
a_{k_n} a_{k_{n+1}}^\dagger.
\end{dmath}
By the Wick operator definition, this may be rewritten with the \( a^\dagger_{k_{n+1}} \) at the end, that is
\begin{dmath}\label{eqn:ProblemSet4Problem4:140}
\normalorder{A_1 A_2 \ldots A_n} B
=
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
\contraction{}{a}{{}_{k_{r+1}}
\ldots
a_{k_{n-1}}
a_{k_n}}
{a}
a_{k_{r+1}}
\ldots
a_{k_{n-1}}
a_{k_n}
a_{k_{n+1}}^\dagger
+
\cdots
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
a_{k_{n-2}}
\contraction{}{a}{{}_{k_{n-1}}
a_{k_n}
}{a}
a_{k_{n-1}}
a_{k_n}
a_{k_{n+1}}^\dagger
+
a_{k_1}^\dagger \ldots a_{k_r}^\dagger
a_{k_{r+1}}
\ldots
\contraction{}{a}{{}_{k_n} }{a}
a_{k_n} a_{k_{n+1}}^\dagger.
\end{dmath}
Since \( \contraction{}{a}{{}^\dagger_{k_{i}}}{a} a^\dagger_{k_{i}} a_{k_{n+1}}^\dagger = 0 \) we may add in contractions with all the creation operators.  Doing that completes the proof of \cref{lemma}.

For a contraction such as that of \cref{eqn:ProblemSet4Problem1:160} we need only modify the trailing sum of contractions.  That is
\begin{equation}\label{eqn:ProblemSet4Problem1:180}
\normalorder{A_1 \contraction{}{A}{{}_2\ldots}{A} A_2 \ldots  A_p \ldots A_n} B
=
\normalorder{A_1 \contraction{}{A}{{}_2\ldots}{A} A_2 \ldots  A_p \ldots A_n B}
+
\sum\limits_{1 \ge k, k \notin \setlr{2,p}, k \le n}
\bcontraction{: A_1 A_2 \ldots }{A}{{}_k \ldots  A_p \ldots A_n :}{B}
: A_1 \contraction{}{A}{{}_2\ldots A_k \ldots}{A} A_2 \ldots A_k \ldots  A_p \ldots A_n : B.
\end{equation}
This will clearly also be the case if the operator sequence \( \normalorder{A_1 \ldots A_n} \) includes any number of other contractions.

\makeSubAnswer{}{qft:problemSet4:1b}
Let's start in a more pedestrian fashion than diving straight into the induction, considering the first few values of \( n \) explicitly.
\begin{itemize}
\item \( n = 2 \).
We'd like to expand \( A B \), say, in terms of contractions.  Because \( A = \normalorder{A} \), that is
\begin{dmath}\label{eqn:ProblemSet4Problem1:220}
A B
= \normalorder{A} B
=
\normalorder{ A B } +
\contraction{}{A}{}{B}
A B
,
\end{dmath}
by \cref{lemma}.  This proves \cref{w1} for the \( n = 2 \) case.
\item \( n = 3 \).  Let's now expand \( A B C \)
\begin{dmath}\label{eqn:ProblemSet4Problem1:240}
A B C
=
(A B) C
=
\lr{
   \normalorder{ A B } +
   \contraction{}{A}{}{B}
   A B
} C.
\end{dmath}
We are now able to apply \cref{lemma} to \( \normalorder{ AB } C \), to find
\begin{dmath}\label{eqn:ProblemSet4Problem1:260}
A B C
=
\lr{
   \normalorder{ A B } +
   \contraction{}{A}{}{B}
   A B
} C
=
\normalorder{ A B C }
+
\normalorder{ A \contraction{}{ B }{}{C } B C }
+
\normalorder{ \contraction{}{ A }{B}{C } A B C }
+
(\contraction{}{A}{}{B}
   A B ) C
=
\normalorder{ A B C }
+
\normalorder{ A \contraction{}{ B }{}{C } B C }
+
\normalorder{ \contraction{}{ A }{B}{C } A B C }
+
\normalorder{ \contraction{}{A}{}{B} A B C },
\end{dmath}
where we also made use of \( \normalorder{ \contraction{}{A}{}{B} A B } C = \normalorder{ \contraction{}{A}{}{B} A B C } \).
This proves \cref{w1} for the \( n = 3 \) case.
\item \( n = 4 \).  This time we have
\begin{dmath}\label{eqn:ProblemSet4Problem1:300}
\begin{aligned}
A B C D
&=
(A B C) D \\
&=
\lr{
\normalorder{ A B C }
+
\normalorder{ A \contraction{}{ B }{}{C } B C }
+
\normalorder{ \contraction{}{ A }{B}{C } A B C }
+
\normalorder{ \contraction{}{A}{}{B} A B C }
} D \\
&=
\normalorder{ A B C D } +
\normalorder{
   \contraction{}{A}{B C}{D}
   A B C D
}
+
\normalorder{
   \contraction{A}{B}{C}{D}
   A B C D
}
+
\normalorder{
   \contraction{A B}{C}{}{D}
   A B C D
} \\
&\qquad+
\normalorder{
   \bcontraction{}{A}{\contraction{}{ B }{}{C } B C}{ D}
   A \contraction{}{ B }{}{C } B C D
}
+
\normalorder{
   \bcontraction{A}{B}{C}{D}
   \contraction{}{ A }{B}{C }
   A B C D
}
+
\normalorder{
   \contraction{}{A}{}{B} A B
   \bcontraction{}{C}{}{D} C D
}.
\end{aligned}
\end{dmath}
This time we have the normal ordering of all the operators, of all the operators with one set of contractions and of all the operators with two sets of contractions (although in that last case, the normal ordering is redundant.)

\item \( n + 1 \).  The way to proceed is now clear, but is just hard to write.
\begin{dmath}\label{eqn:ProblemSet4Problem1:280}
\begin{aligned}
A_1 \ldots A_n A_{n+1}
&=
(A_1 \ldots A_n) A_{n+1} \\
&=
\Biglr{
\normalorder{A_1 \ldots A_n} \\
&\qquad+
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 A_3\ldots A_n}
+ \ldots +
\normalorder{\contraction{}{A}{{}_1\ldots}{A} A_1 \ldots A_{n-1} A_n}
+
\normalorder{\contraction{}{A}{{}_1 \ldots}{A} A_1 \ldots A_{n}} \\
&\qquad+
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 \contraction{}{A}{{}_3}{A} A_3 A_4 \ldots A_n}
 + \ldots
} A_{n+1} \\
&=
\normalorder{A_1 \ldots A_n A_{n+1}} + \sum_{k \ne n + 1}
\normalorder{
\contraction{A_1 \ldots }{A}{{}_k \ldots A_n }{A}
A_1 \ldots A_k \ldots A_n A_{n+1}
}  \\
&\qquad+
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 A_3\ldots A_n A_{n+1}}
+
\sum_{k \notin \setlr{1,2,n+1}}
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 \ldots
\contraction{}{A}{{}_k\ldots A_n }{A}
A_k\ldots A_n A_{n+1}
}
+ \cdots \\
&\qquad+
\normalorder{\contraction{}{A}{{}_1}{A} A_1 A_2 \contraction{}{A}{{}_3}{A} A_3 A_4 \ldots A_n A_{n+1}}
+
\sum_{k \notin \setlr{1,2,3,4,n+1}}
\normalorder{
   \contraction{}{A}{{}_1}{A} A_1 A_2 \contraction{}{A}{{}_3}{A} A_3 A_4 \ldots
   \contraction{}{A}{{}_k \ldots A_n}{A}
   A_k \ldots A_n A_{n+1}
}
+ \cdots
\end{aligned}
\end{dmath}
Reading between the dots, we see that this is the (normal ordered) of all possible contractions, completing the proof of \cref{w1}\footnote{While this barrage of visually discordant contractions can be thought of as a proof of the result, I find the concrete example of the \( n = 4 \) case much more satisfying as a ``proof'', despite not being general.  There the idea is clear, even without the formalism of an inductive proof.}.

\end{itemize}

\makeSubAnswer{}{qft:problemSet4:1c}
TODO.
\makeSubAnswer{}{qft:problemSet4:1d}
TODO.
\makeSubAnswer{}{qft:problemSet4:1e}
TODO.
}
